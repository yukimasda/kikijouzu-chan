<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>聞き上手ちゃん</title>
  <style>
    body { font-family: sans-serif; padding: 2em; background: #fff0f5; }
    h1 { color: #d63384; }
    button { padding: 1em; font-size: 1.2em; }
    .log { margin-top: 2em; }
    .log div { margin: 1em 0; }
    .user { color: #333; }
    .ai { color: #d63384; font-weight: bold; }
  </style>
</head>
<body>
  <h1>聞き上手ちゃん</h1>
  <p>怒りも愚痴もぜ〜んぶ聞いちゃう♪</p>
  <button id="start">話す（クリックして愚痴って）</button>
  <div class="log" id="log"></div>

  <script>
    const button = document.getElementById('start');
    const log = document.getElementById('log');

    const responses = [
      "え〜マジやばくない？それムカつくね〜！",
      "それ、アンタ悪くないよ〜！",
      "上司、空気読めなすぎ〜ウケる〜。",
      "つらたん…飲もっか？笑",
      "あーそれ私だったらキレてる〜！",
      "うんうん、もっと言って！"
    ];

    const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
    recognition.lang = 'ja-JP';
    recognition.interimResults = false;
    recognition.maxAlternatives = 1;

    button.onclick = () => {
      recognition.start();
      button.textContent = '聞いてるよ〜（話して！）';
    };

    recognition.onresult = (event) => {
      const transcript = event.results[0][0].transcript;
      log.innerHTML += `<div class="user">あなた：${transcript}</div>`;
      const aiText = responses[Math.floor(Math.random() * responses.length)];
      log.innerHTML += `<div class="ai">聞き上手ちゃん：${aiText}</div>`;
      speak(aiText);
      button.textContent = '話す（クリックして愚痴って）';
    };

    recognition.onerror = (event) => {
      alert('音声認識エラー：' + event.error);
      button.textContent = '話す（クリックして愚痴って）';
    };

    function speak(text) {
      const utterance = new SpeechSynthesisUtterance(text);
      utterance.lang = 'ja-JP';
      utterance.pitch = 1.3;
      utterance.rate = 1;
      speechSynthesis.speak(utterance);
    }
  </script>
</body>
</html>
